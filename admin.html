<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Painel Barman - Gil Eventos</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;800&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Poppins', sans-serif; background-color: #121212; color: #EAEAEA; margin: 0; padding: 20px; padding-bottom: 80px; }
        .input-3d { padding: 15px; border-radius: 12px; border: 1px solid #333; background: #1E1E1E; color: #fff; width: 100%; font-size: 1.1em; margin-bottom: 10px; box-sizing: border-box; }
        
        .btn-action { width: 100%; padding: 15px; font-weight: bold; border-radius: 10px; border: none; cursor: pointer; margin-bottom: 10px; font-size: 1em; }
        .btn-add { background: #FF9500; color: #000; }
        
        .queue-grid { display: grid; grid-template-columns: 1fr; gap: 10px; margin-top: 20px; }
        
        .order-card { 
            background: #222; padding: 15px; border-radius: 10px; border-left: 5px solid #FF9500; 
            display: flex; justify-content: space-between; align-items: center; 
        }
        .order-card.ready { border-left-color: #00E676; background: rgba(0, 230, 118, 0.1); }
        
        .order-name { font-size: 1.2em; font-weight: bold; color: #fff; }
        .order-time { font-size: 0.8em; color: #777; }

        .btn-icon { width: 40px; height: 40px; border-radius: 50%; border: none; font-size: 1.2em; cursor: pointer; margin-left: 5px; }
        .btn-check { background: #00E676; color: #000; }
        .btn-trash { background: #F44336; color: #fff; }

        h2 { color: #FF9500; border-bottom: 1px solid #333; padding-bottom: 10px; }
    </style>
</head>
<body>

    <h2>üçπ Opera√ß√£o de Bar (Fila)</h2>
    
    <input type="text" id="nomeCliente" class="input-3d" placeholder="Nome ou N¬∫ Mesa (Ex: Jo√£o ou 12)">
    <button class="btn-action btn-add" onclick="adicionarFila()">‚ûï MANDAR PARA O TEL√ÉO</button>

    <div style="display:flex; justify-content:space-between; margin-top:20px; color:#aaa; font-size:0.9em;">
        <span>‚è≥ Em Preparo (<span id="countPrep">0</span>)</span>
        <span>‚úÖ Prontos (<span id="countReady">0</span>)</span>
    </div>

    <div id="listaPedidos" class="queue-grid">
        </div>

    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-firestore-compat.js"></script>
    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyDLPi5Mf6_9ypigmf3v9Qe9YYPUr1mfaHk",
            authDomain: "gil-eventos-app-911fe.firebaseapp.com",
            projectId: "gil-eventos-app-911fe",
            storageBucket: "gil-eventos-app-911fe.firebasestorage.app",
            messagingSenderId: "503025880352",
            appId: "1:503025880352:web:694b7f2889cff501c7db45"
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();

        // Carregar Fila em Tempo Real
        db.collection("fila_bar").orderBy("timestamp", "desc").onSnapshot(snapshot => {
            const lista = document.getElementById("listaPedidos");
            lista.innerHTML = "";
            let prep = 0;
            let ready = 0;

            snapshot.forEach(doc => {
                const p = doc.data();
                const id = doc.id;
                
                if(p.status === 'preparando') prep++;
                if(p.status === 'pronto') ready++;

                const btnAction = p.status === 'preparando' 
                    ? `<button class="btn-icon btn-check" onclick="mudarStatus('${id}', 'pronto')">‚úÖ</button>`
                    : `<button class="btn-icon btn-trash" onclick="deletarPedido('${id}')">‚úñ</button>`;

                lista.innerHTML += `
                    <div class="order-card ${p.status}">
                        <div>
                            <div class="order-name">${p.nome}</div>
                            <div class="order-time">${p.status === 'preparando' ? '‚è≥ Preparando...' : '‚ú® Pronto!'}</div>
                        </div>
                        <div>${btnAction}</div>
                    </div>
                `;
            });

            document.getElementById("countPrep").innerText = prep;
            document.getElementById("countReady").innerText = ready;
        });

        function adicionarFila() {
            const nome = document.getElementById("nomeCliente").value;
            if(!nome) return;
            db.collection("fila_bar").add({
                nome: nome,
                status: 'preparando',
                timestamp: firebase.firestore.FieldValue.serverTimestamp()
            });
            document.getElementById("nomeCliente").value = "";
            document.getElementById("nomeCliente").focus();
        }

        function mudarStatus(id, status) {
            db.collection("fila_bar").doc(id).update({ status: status });
        }

        function deletarPedido(id) {
            db.collection("fila_bar").doc(id).delete();
        }
    </script>
</body>
</html>
